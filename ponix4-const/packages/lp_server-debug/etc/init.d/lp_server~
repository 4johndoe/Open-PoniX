#!/bin/sh

. $TS_GLOBAL

case "$1" in  
init)
    if ! pkg_initialized $PACKAGE; then
        echo "!!!!!!!!!!!!!!!!!!!!!!1111" >> /var/log/boot.log
	let x=0
	PRINTER_X_NAME=$PRINTER_0_NAME
echo "!!!!!!!!!!!!!!!!!!!!!!2222" >> /var/log/boot.log
	while [ -n "$PRINTER_X_NAME" ] ; do
	
	echo "!!!!!!!!!!!!!!!!!!!!!!33333" >> /var/log/boot.log
		PRINTER_X_DEVICE=`eval echo '$PRINTER_'$x'_DEVICE'`
		PRINTER_X_TYPE=`eval echo '$PRINTER_'$x'_TYPE'`
		PRINTER_X_OPTIONS=`eval echo '$PRINTER_'$x'_OPTIONS'`
	  if [ -n "$PRINTER_X_NAME" ]; then
	  echo "!!!!!!!!!!!!!!!!!!!!!!44444" >> /var/log/boot.log
#	    if [ "$PRINTER_X_TYPE" = "S" ]; then
#	        echo "Starting lp_server on $PRINTER_X_DEVICE COM or LPT port"
#		/bin/lp_server -d $PRINTER_X_DEVICE -n 910$x -t "$PRINTER_X_OPTIONS" &
echo "!!!!!!!!!!!!!!!!!!!!!!555555" >> /var/log/boot.log


/bin/lp_server -d $PRINTER_X_DEVICE -n 910$x -t "$PRINTER_X_OPTIONS" &
#	    else
#	        echo "`ls -lR /dev/`" > /var/log/dev
#	        echo "Starting lp_server on $PRINTER_X_DEVICE USB port"
#	        nohup /bin/lp_immortal -d $PRINTER_X_DEVICE -n 910$x &
#	    fi
	  fi
	  let x=x+1
	  PRINTER_X_NAME=`eval echo '\$PRINTER_'$x'_NAME'`
        done

	pkg_set_init_flag $PACKAGE

    fi

    ;;
help)
    echo "Usage: $0 init"
    ;;
  *)
    exit 1
    ;;
esac

exit 0
