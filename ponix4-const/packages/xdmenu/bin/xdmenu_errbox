#!/bin/sh

. $TS_GLOBAL
load_lang base

XDMSGBOX_HEIGHT=14
XDMSGBOX_WIDTH=64

XDMENU_FOCUS_BIN=/bin/xdmenu_focus

if [ "$1" = "" ] ; then
	echo "Usage: xdmenu_msgbox text"
	exit
fi

if [ "$XD_USE_CONSOLE" = "ON" ] ; then
	echo -e $1
	exit
fi


if [ -z "`pidof Xorg`" ] ; then
	/bin/repli_msgbox "$1"
	exit
fi

if [ "$DISPLAY" = "" ] ; then
	echo "DISPLAY is not set..."
	exit
fi

# this is for 'bring_session_to_front' script to correctly
# bring up dialogs from the session which runs them in .deskrun
# (all because Xdialog doesn't set _WM_PID)
if [ -n "$SESSION_ID" ] ; then
	CLASSNAME='dialog_session'$SESSION_ID
else
	CLASSNAME='xdmenu_msgbox'
fi

# Running Xdialog #####################################

WID=`xdotool search --class "$CLASSNAME"`

if [ "$WID" != "" ] ; then
	xdotool windowkill $WID
fi

$XDMENU_FOCUS_BIN $CLASSNAME &
                                                                
eval "/bin/Xdialog --rc-file /etc/gtkrc.fixedfont --title \"\" --wmclass $CLASSNAME --icon "/share/icons/achtung.xpm" --wrap --msgbox \"$1\" $XDMSGBOX_HEIGHT $XDMSGBOX_WIDTH 2>>$LOGFILE"

